{"ast":null,"code":"import _asyncToGenerator from \"C:\\\\Users\\\\Usuario\\\\Documents\\\\ingenieriamultimedia\\\\TFG\\\\HangingOut\\\\frontend\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";\nimport { Validators } from '@angular/forms';\nimport Swal from 'sweetalert2';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"src/app/services/actividades.service\";\nimport * as i3 from \"../../services/usuario.service\";\nimport * as i4 from \"src/app/services/provincias.service\";\nimport * as i5 from \"src/app/services/categorias.service\";\nimport * as i6 from \"@angular/router\";\nimport * as i7 from \"@angular/common\";\n\nfunction CrearActividadComponent_p_40_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 72);\n    i0.ɵɵtext(1, \"* El titulo es obligatorio\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction CrearActividadComponent_p_46_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 72);\n    i0.ɵɵtext(1, \"* La descripci\\u00F3n es obligatoria y debe tener al menos 120 caracteres\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction CrearActividadComponent_p_52_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 72);\n    i0.ɵɵtext(1, \"* Los requisitos son obligatorios\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction CrearActividadComponent_p_65_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 72);\n    i0.ɵɵtext(1, \"* La fecha y hora son obligatorias\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction CrearActividadComponent_p_84_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 72);\n    i0.ɵɵtext(1, \"* El precio es obligatorio\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction CrearActividadComponent_p_85_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 72);\n    i0.ɵɵtext(1, \"* Por favor, introduzca un m\\u00EDnimo de participantes\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction CrearActividadComponent_p_90_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 72);\n    i0.ɵɵtext(1, \"* La direccion es obligatoria\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction CrearActividadComponent_p_95_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 72);\n    i0.ɵɵtext(1, \"* La poblaci\\u00F3n es obligatoria\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction CrearActividadComponent_option_103_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 73);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const provincia_r17 = ctx.$implicit;\n    i0.ɵɵpropertyInterpolate(\"value\", provincia_r17.uid);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(provincia_r17.nombre);\n  }\n}\n\nfunction CrearActividadComponent_p_104_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 72);\n    i0.ɵɵtext(1, \"* La provincia es obligatoria\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction CrearActividadComponent_div_109_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 74);\n    i0.ɵɵelement(1, \"img\", 75);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const foto_r18 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate(\"src\", foto_r18, i0.ɵɵsanitizeUrl);\n  }\n}\n\nfunction CrearActividadComponent_div_110_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r20 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 76)(1, \"i\", 77);\n    i0.ɵɵlistener(\"click\", function CrearActividadComponent_div_110_Template_i_click_1_listener() {\n      i0.ɵɵrestoreView(_r20);\n      i0.ɵɵnextContext();\n\n      const _r12 = i0.ɵɵreference(116);\n\n      return _r12.click();\n    });\n    i0.ɵɵelementEnd()();\n  }\n}\n\nfunction CrearActividadComponent_div_121_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r24 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\")(1, \"input\", 78);\n    i0.ɵɵlistener(\"change\", function CrearActividadComponent_div_121_Template_input_change_1_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r24);\n      const categoria_r21 = restoredCtx.$implicit;\n      const ctx_r23 = i0.ɵɵnextContext();\n      return ctx_r23.onCheckboxChange($event, categoria_r21.uid);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(2, \"label\", 79);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const categoria_r21 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate(\"id\", categoria_r21.uid);\n    i0.ɵɵpropertyInterpolate(\"value\", categoria_r21.nombre);\n    i0.ɵɵproperty(\"checked\", categoria_r21.marcado);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(categoria_r21.nombre);\n  }\n}\n\nfunction CrearActividadComponent_p_122_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 80);\n    i0.ɵɵtext(1, \"* Por favor, seleccione m\\u00EDnimo una categor\\u00EDa\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction CrearActividadComponent_button_133_i_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"i\", 83);\n  }\n}\n\nfunction CrearActividadComponent_button_133_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"button\", 81);\n    i0.ɵɵtemplate(1, CrearActividadComponent_button_133_i_1_Template, 1, 0, \"i\", 82);\n    i0.ɵɵtext(2, \"Crear Actividad\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r15 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r15.waiting);\n  }\n}\n\nfunction CrearActividadComponent_button_134_i_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"i\", 83);\n  }\n}\n\nfunction CrearActividadComponent_button_134_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"button\", 81);\n    i0.ɵɵtemplate(1, CrearActividadComponent_button_134_i_1_Template, 1, 0, \"i\", 82);\n    i0.ɵɵtext(2, \"Editar Actividad\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r16 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r16.waiting);\n  }\n}\n\nexport let CrearActividadComponent = /*#__PURE__*/(() => {\n  class CrearActividadComponent {\n    constructor(fb, actividadService, usuarioService, provinciaService, categoriasService, router, route) {\n      this.fb = fb;\n      this.actividadService = actividadService;\n      this.usuarioService = usuarioService;\n      this.provinciaService = provinciaService;\n      this.categoriasService = categoriasService;\n      this.router = router;\n      this.route = route;\n      this.registerForm = this.fb.group({\n        organizador: [''],\n        titulo: ['', Validators.required],\n        descripcion: ['', Validators.required],\n        requisitos: ['', Validators.required],\n        fecha: ['', [Validators.required]],\n        hora: ['', Validators.required],\n        direccion: ['', [Validators.required]],\n        poblacion: ['', Validators.required],\n        provincia: ['', Validators.required],\n        min_participantes: ['', Validators.required],\n        max_participantes: ['', Validators.required],\n        precio: ['', Validators.required],\n        categorias: [new Array([]), Validators.required],\n        participa: [''],\n        imagenes: [''],\n        fotos: ['']\n      });\n      this.fechaInvalida = false;\n      this.faltaCategoria = false;\n      this.nuevo = false;\n      this.titulo = \"Editar Actividad\";\n      this.listaCategorias = [];\n      this.listaFotos = [];\n      this.listaArchivos = [];\n      this.filechanged = false;\n      this.listaProvincias = [];\n      this.participa = false;\n      this.formSubmit = false;\n      this.waiting = false; // public participacion = [\n      //   {id: 1, nombre: \"Sí\", marcado: false},\n      //   {id: 2, nombre: \"No\", marcado: false},\n      // ];\n\n      this.checked1 = false;\n      this.checked2 = false;\n      this.pathFotos = \"\";\n    }\n\n    ngOnInit() {\n      this.actividadId = this.route.snapshot.params['uid'];\n      this.cargarProvincias();\n      this.queDiaEsHoy();\n      this.cargarCategorias();\n      this.cargarOrganizador();\n\n      if (!this.actividadId) {\n        this.actividadId = 'nuevo';\n        this.nuevo = true;\n        this.titulo = \"Crear Actividad\";\n      } else {\n        this.cargarActividad();\n      }\n\n      this.pathFotos = \"../../../assets/imgs/actividades/\";\n    }\n\n    cargarActividad() {\n      this.actividadService.cargarActividad(this.actividadId).subscribe(res => {\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p;\n\n        let actividad = res['existeActividad'];\n        console.log(actividad);\n        (_a = this.registerForm.get('titulo')) === null || _a === void 0 ? void 0 : _a.setValue(actividad.titulo);\n        (_b = this.registerForm.get('descripcion')) === null || _b === void 0 ? void 0 : _b.setValue(actividad.descripcion);\n        (_c = this.registerForm.get('requisitos')) === null || _c === void 0 ? void 0 : _c.setValue(actividad.requisitos);\n        (_d = this.registerForm.get('imagenes')) === null || _d === void 0 ? void 0 : _d.setValue(actividad.fotos);\n        (_e = this.registerForm.get('min_participantes')) === null || _e === void 0 ? void 0 : _e.setValue(actividad.min_participantes);\n        (_f = this.registerForm.get('max_participantes')) === null || _f === void 0 ? void 0 : _f.setValue(actividad.max_participantes);\n        (_g = this.registerForm.get('direccion')) === null || _g === void 0 ? void 0 : _g.setValue(actividad.direccion);\n        (_h = this.registerForm.get('poblacion')) === null || _h === void 0 ? void 0 : _h.setValue(actividad.poblacion);\n        (_j = this.registerForm.get('provincia')) === null || _j === void 0 ? void 0 : _j.setValue(actividad.provincia);\n        (_k = this.registerForm.get('pais')) === null || _k === void 0 ? void 0 : _k.setValue(actividad.pais);\n        let fecha = new Date(actividad.fecha);\n        (_l = this.registerForm.get('fecha')) === null || _l === void 0 ? void 0 : _l.setValue(this.convertirFecha(fecha));\n        (_m = this.registerForm.get('hora')) === null || _m === void 0 ? void 0 : _m.setValue(this.convertirHora(fecha));\n        (_o = this.registerForm.get('participa')) === null || _o === void 0 ? void 0 : _o.setValue(actividad.participa);\n        this.organizador = actividad.organizador;\n\n        if (actividad.participa) {\n          this.participa = true;\n        }\n\n        (_p = this.registerForm.get('precio')) === null || _p === void 0 ? void 0 : _p.setValue(actividad.precio);\n\n        for (let i = 0; i < actividad.categorias.length; i++) {\n          for (let j = 0; j < this.listaCategorias.length; j++) {\n            if (actividad.categorias[i] === this.listaCategorias[j].uid) {\n              this.listaCategorias[j].marcado = true;\n            }\n          }\n        }\n\n        for (let i = 0; i < actividad.fotos.length; i++) {\n          let img = this.pathFotos + actividad.fotos[i];\n          this.listaFotos.push(img);\n        }\n      }, err => {\n        console.log(err);\n      });\n    }\n\n    cargarOrganizador() {\n      let email = localStorage.getItem('email');\n\n      if (!email) {\n        email = \"\";\n      }\n\n      this.usuarioService.cargarUsuario(\"\", email).subscribe(res => {\n        this.usuarioId = res['existeUsuario'].uid;\n      }, err => {\n        console.log(err);\n      });\n    }\n\n    convertirFechayHora() {\n      var _a, _b, _c;\n\n      let fecha = new Date((_a = this.registerForm.get('fecha')) === null || _a === void 0 ? void 0 : _a.value);\n      let nuevaFecha = new Date();\n      let sh = (_b = this.registerForm.get('hora')) === null || _b === void 0 ? void 0 : _b.value.split(':')[0];\n      let sm = (_c = this.registerForm.get('hora')) === null || _c === void 0 ? void 0 : _c.value.split(':')[1];\n      nuevaFecha.setFullYear(fecha.getFullYear());\n      nuevaFecha.setMonth(fecha.getMonth());\n      nuevaFecha.setDate(fecha.getDate());\n      nuevaFecha.setHours(sh);\n      nuevaFecha.setMinutes(sm);\n      return nuevaFecha;\n    }\n\n    crearActividad() {\n      var _a, _b, _c, _d, _e, _f, _g, _h, _j;\n\n      this.formSubmit = true;\n\n      if (this.nuevo) {\n        (_a = this.registerForm.get('organizador')) === null || _a === void 0 ? void 0 : _a.setValue(this.organizador);\n        console.log(this.registerForm.value);\n\n        if (!this.registerForm.valid) {\n          window.scroll({\n            top: 0,\n            left: 0,\n            behavior: 'smooth'\n          });\n          console.log('el formulario no es válido');\n          return;\n        }\n\n        this.waiting = true;\n        console.log('quiero crear una actividad');\n        console.log(this.registerForm.value);\n        let categorias = [];\n\n        for (let i = 0; i < this.listaCategorias.length; i++) {\n          if (this.listaCategorias[i].marcado) {\n            categorias.push(this.listaCategorias[i].uid);\n          }\n        }\n\n        (_b = this.registerForm.get('fecha')) === null || _b === void 0 ? void 0 : _b.setValue(this.convertirFechayHora());\n        (_c = this.registerForm.get('participa')) === null || _c === void 0 ? void 0 : _c.setValue(this.participa);\n        (_d = this.registerForm.get('categorias')) === null || _d === void 0 ? void 0 : _d.setValue(categorias);\n        (_e = this.registerForm.get('organizador')) === null || _e === void 0 ? void 0 : _e.setValue(this.usuarioId);\n        this.actividadService.crearActividad(this.registerForm.value).subscribe(res => {\n          if (this.filechanged) {\n            this.subirFotos(res['actividad'].uid);\n          }\n\n          this.waiting = false;\n        }, err => {\n          console.log(err);\n          this.waiting = false;\n          const msgerror = err.error.msg || 'No se pudo completar la acción, vuelva a intentarlo';\n          Swal.fire({\n            icon: 'error',\n            title: 'Oops...',\n            text: msgerror\n          });\n        });\n      } else {\n        this.waiting = true;\n        let categorias = [];\n\n        for (let i = 0; i < this.listaCategorias.length; i++) {\n          if (this.listaCategorias[i].marcado) {\n            categorias.push(this.listaCategorias[i].uid);\n          }\n        }\n\n        (_f = this.registerForm.get('fecha')) === null || _f === void 0 ? void 0 : _f.setValue(this.convertirFechayHora());\n        (_g = this.registerForm.get('categorias')) === null || _g === void 0 ? void 0 : _g.setValue(categorias);\n        (_h = this.registerForm.get('organizador')) === null || _h === void 0 ? void 0 : _h.setValue(this.organizador);\n\n        if (this.filechanged) {\n          this.subirFotos(this.actividadId);\n        } else {\n          (_j = this.registerForm.get('fotos')) === null || _j === void 0 ? void 0 : _j.setValue(this.registerForm.controls['imagenes'].value);\n          console.log(this.registerForm.value);\n          this.actividadService.actualizarActividad(this.actividadId, this.registerForm.value).subscribe(res => {\n            this.waiting = false;\n            Swal.fire({\n              icon: 'success',\n              title: 'Hecho!',\n              text: 'Actividad actualizada correctamente'\n            }).then(result => {\n              if (result.isConfirmed) {\n                this.router.navigateByUrl('/admin/actividades');\n              }\n            });\n          }, err => {\n            this.waiting = false;\n            console.log(err);\n          });\n        }\n      }\n    }\n\n    cargarProvincias() {\n      this.provinciaService.cargarProvincias().subscribe(res => {\n        console.log(res);\n        this.listaProvincias = res['provincias'];\n      }, err => {\n        const msgerror = err.error.msg || 'No se pudo completar la acción, vuelva a intentarlo';\n        Swal.fire({\n          icon: 'error',\n          title: 'Oops...',\n          text: msgerror\n        });\n      });\n    }\n\n    cargarCategorias() {\n      this.categoriasService.cargarCategorias().subscribe(res => {\n        this.listaCategorias = res['categorias'];\n        console.log(this.listaCategorias);\n      }, err => {\n        const msgerror = err.error.msg || 'No se pudo completar la acción, vuelva a intentarlo';\n        Swal.fire({\n          icon: 'error',\n          title: 'Oops...',\n          text: msgerror\n        });\n      });\n    }\n\n    selectFiles(event) {\n      var _this = this;\n\n      return _asyncToGenerator(function* () {\n        _this.filechanged = true;\n        const filesToUpload = event.target.files;\n\n        _this.listaArchivos.push(filesToUpload[0]);\n\n        console.log(filesToUpload);\n        var reader = new FileReader(); // this.imagePath = event.target.files;\n\n        reader.readAsDataURL(filesToUpload[0]);\n\n        reader.onload = _event => {\n          _this.listaFotos.push(reader.result);\n        };\n      })();\n    }\n\n    subirFotos(idActividad) {\n      const formData = new FormData();\n      console.log(this.listaArchivos);\n\n      for (let i = 0; i < this.listaArchivos.length; i++) {\n        formData.append('fotos', this.listaArchivos[i]);\n      }\n\n      console.log(formData);\n      this.actividadService.subirFotos(idActividad, formData).subscribe(res => {\n        var _a, _b, _c;\n\n        console.log(res);\n        let fotos = (_a = this.registerForm.get('imagenes')) === null || _a === void 0 ? void 0 : _a.value;\n\n        if (!fotos) {\n          fotos = [];\n        }\n\n        for (let i = 0; i < res['listaFotos'].length; i++) {\n          if (fotos[0] == \"\") {\n            fotos[0] = res['listaFotos'][i];\n          } else {\n            fotos.push(res['listaFotos'][i]);\n          }\n        }\n\n        (_b = this.registerForm.get('imagenes')) === null || _b === void 0 ? void 0 : _b.setValue(fotos);\n        (_c = this.registerForm.get('fotos')) === null || _c === void 0 ? void 0 : _c.setValue(fotos);\n        this.actividadService.actualizarActividad(idActividad, this.registerForm.value).subscribe(res => {\n          console.log(res);\n\n          if (this.nuevo) {\n            Swal.fire({\n              icon: 'success',\n              title: 'Hecho!',\n              text: 'Actividad creada correctamente'\n            }).then(result => {\n              if (result.isConfirmed) {\n                this.router.navigateByUrl('/admin/actividades');\n              }\n            });\n          } else {\n            Swal.fire({\n              icon: 'success',\n              title: 'Hecho!',\n              text: 'Actividad actualizada correctamente'\n            }).then(result => {\n              if (result.isConfirmed) {\n                this.router.navigateByUrl('/admin/actividades');\n              }\n            });\n          }\n        }, err => {\n          console.log(err);\n        });\n      }, err => {\n        console.log(err);\n        const msgerror = err.error.msg || 'No se pudo completar la acción, vuelva a intentarlo';\n        Swal.fire({\n          icon: 'error',\n          title: 'Oops...',\n          text: msgerror\n        });\n      });\n    }\n\n    onCheckboxChange(e, uid) {\n      if (e.target.checked) {\n        for (let i = 0; i < this.listaCategorias.length; i++) {\n          if (this.listaCategorias[i].uid === uid) {\n            this.listaCategorias[i].marcado = true;\n          }\n        }\n      } else {\n        for (let i = 0; i < this.listaCategorias.length; i++) {\n          if (this.listaCategorias[i].uid === uid) {\n            this.listaCategorias[i].marcado = false;\n          }\n        }\n      }\n    }\n\n    borrarFotos() {\n      console.log(\"Quiero borrar fotos\");\n      this.listaFotos = [];\n      this.listaArchivos = [];\n\n      if (!this.nuevo) {\n        this.actividadService.borrarFotos(this.actividadId).subscribe(res => {\n          var _a;\n\n          let fotos = [];\n          (_a = this.registerForm.get('imagenes')) === null || _a === void 0 ? void 0 : _a.setValue(fotos);\n          console.log(res);\n        }, err => {\n          console.log(err);\n          const msgerror = err.error.msg || 'No se pudo completar la acción, vuelva a intentarlo';\n          Swal.fire({\n            icon: 'error',\n            title: 'Oops...',\n            text: msgerror\n          });\n        });\n      }\n    } // seleccionar(id: any){\n    //   for(let i = 0; i < this.motivos.length; i++){\n    //     if(id == this.motivos[i].id){\n    //       this.motivos[i].marcado = true;\n    //       this.valido = true;\n    //       if(this.alerta){\n    //         this.alerta = false;\n    //       }\n    //     }else{\n    //       this.motivos[i].marcado = false;\n    //     }\n    //   }\n    // }\n\n\n    onCheckboxChange2(num) {\n      var _a;\n\n      if (num == 1) {\n        if (this.checked1 == false) {\n          this.participa = true;\n          this.checked1 = true;\n          this.checked2 = false;\n        } else {\n          this.participa = false;\n          this.checked1 = false;\n          this.checked2 = true;\n        }\n      } else {\n        if (this.checked2 == false) {\n          this.participa = false;\n          this.checked2 = true;\n          this.checked1 = false;\n        } else {\n          this.participa = true;\n          this.checked2 = false;\n          this.checked1 = true;\n        }\n      }\n\n      (_a = this.registerForm.get('participa')) === null || _a === void 0 ? void 0 : _a.setValue(this.participa);\n    }\n\n    convertirFecha(datecita) {\n      let year = datecita.getFullYear().toString();\n      let month = datecita.getMonth() + 1;\n      let dt = datecita.getDate();\n      let stringo = '',\n          sdia = '',\n          smes = '',\n          syear = '';\n\n      if (dt < 10) {\n        sdia = '0' + dt.toString();\n      } else {\n        sdia = dt.toString();\n      }\n\n      if (month < 10) {\n        smes = '0' + month.toString();\n      } else {\n        smes = month.toString();\n      }\n\n      syear = year.toString();\n      stringo = syear + '-' + smes + '-' + sdia;\n      return stringo;\n    }\n\n    convertirHora(fecha) {\n      let hora = fecha.getHours();\n      let minutos = fecha.getMinutes();\n      let shora = \"\",\n          sminut = \"\";\n\n      if (hora < 10) {\n        shora = \"0\" + hora.toString();\n      } else {\n        shora = hora.toString();\n      }\n\n      if (minutos < 10) {\n        sminut = \"0\" + minutos.toString();\n      } else {\n        sminut = minutos.toString();\n      }\n\n      let resultado = \"\";\n      resultado = shora + \":\" + sminut;\n      return resultado;\n    }\n\n    get arrayCategorias() {\n      return this.registerForm.controls[\"categorias\"];\n    }\n\n    logout() {\n      this.usuarioService.logout();\n    }\n\n    campoValido(campo) {\n      var _a, _b, _c, _d;\n\n      if (campo === 'hora') {\n        if (((_a = this.registerForm.get('fecha')) === null || _a === void 0 ? void 0 : _a.value) != '' && ((_b = this.registerForm.get('hora')) === null || _b === void 0 ? void 0 : _b.value) != '') {\n          var fechaActual = new Date();\n          var f = (_c = this.registerForm.get(campo)) === null || _c === void 0 ? void 0 : _c.value;\n          var hour = f.split(\":\")[0] - fechaActual.getHours();\n\n          if (hour < 2) {\n            this.fechaInvalida = true;\n          }\n\n          if (hour == 2) {\n            let mins = f.split(\":\")[1] - fechaActual.getMinutes();\n\n            if (mins >= 0) {\n              this.fechaInvalida = false;\n            } else {\n              this.fechaInvalida = true;\n            }\n          }\n        } else {\n          this.fechaInvalida = false;\n        }\n      }\n\n      this.comprobarCategorias();\n      return ((_d = this.registerForm.get(campo)) === null || _d === void 0 ? void 0 : _d.valid) || !this.formSubmit;\n    }\n\n    comprobarCategorias() {\n      let cont = 0;\n\n      for (let i = 0; i < this.listaCategorias.length; i++) {\n        if (this.listaCategorias[i].marcado == true) {\n          cont++;\n        }\n      }\n\n      if (cont < 1) {\n        this.faltaCategoria = true;\n      } else {\n        this.faltaCategoria = false;\n      }\n    }\n\n    queDiaEsHoy() {\n      this.hoy = new Date().toISOString().slice(0, 10);\n    }\n\n  }\n\n  CrearActividadComponent.ɵfac = function CrearActividadComponent_Factory(t) {\n    return new (t || CrearActividadComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.ActividadesService), i0.ɵɵdirectiveInject(i3.UsuarioService), i0.ɵɵdirectiveInject(i4.ProvinciaService), i0.ɵɵdirectiveInject(i5.CategoriasService), i0.ɵɵdirectiveInject(i6.Router), i0.ɵɵdirectiveInject(i6.ActivatedRoute));\n  };\n\n  CrearActividadComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: CrearActividadComponent,\n    selectors: [[\"app-crear-actividad\"]],\n    decls: 135,\n    vars: 21,\n    consts: [[1, \"mt-2\", \"admin-nav\"], [1, \"admin-header\"], [1, \"d-flex\"], [\"src\", \"../../../assets/imgs/Logo.png\", 1, \"logo\"], [1, \"mt-5\"], [1, \"admin-nav\"], [1, \"float-left\", \"mr-1\"], [1, \"dropdown\"], [\"type\", \"button\", \"data-toggle\", \"dropdown\", 1, \"menuBoton\"], [1, \"fa-solid\", \"fa-bars\", \"fa-2x\", \"p-1\"], [1, \"dropdown-menu\"], [1, \"dropdown-option\"], [\"routerLink\", \"/admin/usuarios\"], [\"routerLink\", \"/admin/actividades\"], [\"routerLink\", \"/admin/categorias\"], [\"routerLink\", \"/admin/incidencias\"], [1, \"logOutAdmin\", 3, \"click\"], [1, \"d-flex\", \"admin-nav-title\"], [1, \"ml-2\", \"my-auto\"], [1, \"title2\", \"mt-2\"], [1, \"d-flex\", \"my-auto\"], [\"routerLink\", \"/admin/actividades\", 1, \"fa-solid\", \"fa-arrow-rotate-left\", \"fa-2x\", \"mx-3\"], [1, \"resultados\"], [3, \"formGroup\", \"ngSubmit\"], [\"for\", \"nombre\", 1, \"tituloForm\", \"mt-3\"], [\"type\", \"text\", \"formControlName\", \"titulo\", \"required\", \"\", 1, \"inputForm\"], [\"class\", \"small text-danger font-italic invalid-msg\", 4, \"ngIf\"], [\"for\", \"descripcion\", 1, \"tituloForm\"], [\"formControlName\", \"descripcion\", \"minlength\", \"120\", \"required\", \"\", 1, \"inputForm\"], [\"for\", \"requisitos\", 1, \"tituloForm\"], [\"formControlName\", \"requisitos\", \"required\", \"\", 1, \"inputForm\"], [1, \"tituloForm\"], [1, \"fecha\"], [\"for\", \"fecha\"], [\"type\", \"date\", \"formControlName\", \"fecha\", \"value\", \"dd/mm/aaaa\", \"required\", \"\", 1, \"inputForm\", 3, \"min\"], [1, \"fa-solid\", \"fa-calendar-days\", \"crearActividadCalendario\"], [1, \"hora\"], [\"for\", \"hora\"], [\"type\", \"time\", \"formControlName\", \"hora\", \"value\", \"hh:mm\", \"required\", \"\", 1, \"inputForm\"], [\"for\", \"precio\", 1, \"tituloForm\"], [\"type\", \"number\", \"id\", \"precio\", \"formControlName\", \"precio\", \"required\", \"\", 1, \"inputForm\"], [2, \"margin-top\", \"4px\"], [1, \"d-flex\", \"ml-3\", \"participants\"], [\"for\", \"minimo\"], [\"type\", \"number\", \"formControlName\", \"min_participantes\", \"value\", \"0\", \"required\", \"\", 1, \"inputForm\"], [1, \"d-flex\", \"participants\"], [\"for\", \"maximo\"], [\"type\", \"number\", \"formControlName\", \"max_participantes\", 1, \"inputForm\"], [\"for\", \"direccion\", 1, \"tituloForm\"], [\"type\", \"text\", \"formControlName\", \"direccion\", 1, \"inputForm\"], [\"for\", \"poblacion\", 1, \"tituloForm\"], [\"type\", \"text\", \"formControlName\", \"poblacion\", \"required\", \"\", 1, \"inputForm\"], [\"for\", \"provincia\", 1, \"tituloForm\"], [\"id\", \"provincia\", \"formControlName\", \"provincia\", 1, \"inputForm\"], [\"value\", \"\", \"disabled\", \"\", \"selected\", \"\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"for\", \"fotos\", 1, \"tituloForm\"], [1, \"d-flex\", \"pr-3\"], [\"class\", \"marcoFActividad2 mt-0\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"addFoto\", 4, \"ngIf\"], [\"type\", \"button\", 1, \"borrarFotos\", 3, \"click\"], [1, \"divInputFile\", \"mt-3\", \"mx-4\"], [\"id\", \"inputFile\", \"type\", \"file\", \"accept\", \".png, .jpg, .jpeg\", \"hidden\", \"\", \"accept\", \"image/*\", 3, \"change\"], [\"fileInput\", \"\"], [\"id\", \"categorias\"], [\"for\", \"categorias\", 1, \"tituloForm\"], [4, \"ngFor\", \"ngForOf\"], [\"class\", \"small text-danger font-italic invalid-msg mt-1\", 4, \"ngIf\"], [1, \"participa\", \"mt-3\"], [\"for\", \"participa\", 1, \"tituloForm\"], [\"type\", \"checkbox\", 3, \"checked\", \"change\"], [\"class\", \"big-button mt-5\", \"type\", \"submit\", 4, \"ngIf\"], [1, \"small\", \"text-danger\", \"font-italic\", \"invalid-msg\"], [3, \"value\"], [1, \"marcoFActividad2\", \"mt-0\"], [1, \"fActividad\", 3, \"src\"], [1, \"addFoto\"], [1, \"fa-solid\", \"fa-plus\", 3, \"click\"], [\"type\", \"checkbox\", 1, \"mr-2\", \"ml-4\", \"checkCategoria\", 3, \"id\", \"value\", \"checked\", \"change\"], [\"for\", \"categoria\", 1, \"form-check-label\"], [1, \"small\", \"text-danger\", \"font-italic\", \"invalid-msg\", \"mt-1\"], [\"type\", \"submit\", 1, \"big-button\", \"mt-5\"], [\"class\", \"fa fa-spinner fa-spin mr-2\", 4, \"ngIf\"], [1, \"fa\", \"fa-spinner\", \"fa-spin\", \"mr-2\"]],\n    template: function CrearActividadComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"section\", 0)(1, \"header\", 1)(2, \"div\", 2);\n        i0.ɵɵelement(3, \"img\", 3);\n        i0.ɵɵelementStart(4, \"h1\", 4);\n        i0.ɵɵtext(5, \"Panel de Control\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(6, \"nav\", 5)(7, \"div\", 6)(8, \"div\", 7)(9, \"button\", 8);\n        i0.ɵɵelement(10, \"i\", 9);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"div\", 10)(12, \"div\", 11)(13, \"button\", 12);\n        i0.ɵɵtext(14, \"Usuarios\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(15, \"div\", 11)(16, \"button\", 13);\n        i0.ɵɵtext(17, \"Actividades\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(18, \"div\", 11)(19, \"button\", 14);\n        i0.ɵɵtext(20, \"Categor\\u00EDas\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(21, \"div\", 11)(22, \"button\", 15);\n        i0.ɵɵtext(23, \"Incidencias\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(24, \"div\", 11)(25, \"button\", 16);\n        i0.ɵɵlistener(\"click\", function CrearActividadComponent_Template_button_click_25_listener() {\n          return ctx.logout();\n        });\n        i0.ɵɵtext(26, \"Cerrar Sesi\\u00F3n\");\n        i0.ɵɵelementEnd()()()()();\n        i0.ɵɵelementStart(27, \"div\", 17)(28, \"div\", 18)(29, \"h4\", 19);\n        i0.ɵɵtext(30);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(31, \"div\", 20);\n        i0.ɵɵelement(32, \"i\", 21);\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(33, \"div\", 22)(34, \"form\", 23);\n        i0.ɵɵlistener(\"ngSubmit\", function CrearActividadComponent_Template_form_ngSubmit_34_listener() {\n          return ctx.crearActividad();\n        });\n        i0.ɵɵelementStart(35, \"div\")(36, \"label\", 24);\n        i0.ɵɵtext(37, \"Titulo*\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(38, \"br\")(39, \"input\", 25);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(40, CrearActividadComponent_p_40_Template, 2, 0, \"p\", 26);\n        i0.ɵɵelementStart(41, \"div\")(42, \"label\", 27);\n        i0.ɵɵtext(43, \"Descripci\\u00F3n*\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(44, \"br\")(45, \"textarea\", 28);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(46, CrearActividadComponent_p_46_Template, 2, 0, \"p\", 26);\n        i0.ɵɵelementStart(47, \"div\")(48, \"label\", 29);\n        i0.ɵɵtext(49, \"Requisitos*\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(50, \"br\")(51, \"textarea\", 30);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(52, CrearActividadComponent_p_52_Template, 2, 0, \"p\", 26);\n        i0.ɵɵelementStart(53, \"div\")(54, \"h1\", 31);\n        i0.ɵɵtext(55, \"Fecha y Hora*\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(56, \"div\", 2)(57, \"div\", 32);\n        i0.ɵɵelement(58, \"label\", 33);\n        i0.ɵɵelementStart(59, \"div\", 2);\n        i0.ɵɵelement(60, \"input\", 34)(61, \"i\", 35);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(62, \"div\", 36);\n        i0.ɵɵelement(63, \"label\", 37)(64, \"input\", 38);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(65, CrearActividadComponent_p_65_Template, 2, 0, \"p\", 26);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(66, \"div\", 2)(67, \"div\")(68, \"label\", 39);\n        i0.ɵɵtext(69, \"Precio (\\u20AC)*\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(70, \"input\", 40);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(71, \"div\", 41)(72, \"h1\", 31);\n        i0.ɵɵtext(73, \"Participantes*\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(74, \"div\", 2)(75, \"div\", 42)(76, \"label\", 43);\n        i0.ɵɵtext(77, \"M\\u00EDn: \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(78, \"input\", 44);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(79, \"div\", 45)(80, \"label\", 46);\n        i0.ɵɵtext(81, \"M\\u00E1x: \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(82, \"input\", 47);\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(83, \"div\", 2);\n        i0.ɵɵtemplate(84, CrearActividadComponent_p_84_Template, 2, 0, \"p\", 26);\n        i0.ɵɵtemplate(85, CrearActividadComponent_p_85_Template, 2, 0, \"p\", 26);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(86, \"div\")(87, \"label\", 48);\n        i0.ɵɵtext(88, \"Direcci\\u00F3n*\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(89, \"input\", 49);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(90, CrearActividadComponent_p_90_Template, 2, 0, \"p\", 26);\n        i0.ɵɵelementStart(91, \"div\")(92, \"label\", 50);\n        i0.ɵɵtext(93, \"Poblaci\\u00F3n*\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(94, \"input\", 51);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(95, CrearActividadComponent_p_95_Template, 2, 0, \"p\", 26);\n        i0.ɵɵelementStart(96, \"div\")(97, \"label\", 52);\n        i0.ɵɵtext(98, \"Provincia*\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(99, \"br\");\n        i0.ɵɵelementStart(100, \"select\", 53)(101, \"option\", 54);\n        i0.ɵɵtext(102, \"Provincia\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(103, CrearActividadComponent_option_103_Template, 2, 2, \"option\", 55);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(104, CrearActividadComponent_p_104_Template, 2, 0, \"p\", 26);\n        i0.ɵɵelementStart(105, \"div\")(106, \"label\", 56);\n        i0.ɵɵtext(107, \"Fotos*\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(108, \"div\", 57);\n        i0.ɵɵtemplate(109, CrearActividadComponent_div_109_Template, 2, 1, \"div\", 58);\n        i0.ɵɵtemplate(110, CrearActividadComponent_div_110_Template, 2, 0, \"div\", 59);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(111, \"div\")(112, \"button\", 60);\n        i0.ɵɵlistener(\"click\", function CrearActividadComponent_Template_button_click_112_listener() {\n          return ctx.borrarFotos();\n        });\n        i0.ɵɵtext(113, \"Borrar fotos\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(114, \"div\", 61)(115, \"input\", 62, 63);\n        i0.ɵɵlistener(\"change\", function CrearActividadComponent_Template_input_change_115_listener($event) {\n          return ctx.selectFiles($event);\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(117, \"div\", 64)(118, \"label\", 65);\n        i0.ɵɵtext(119, \"Categor\\u00EDas*\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(120, \"br\");\n        i0.ɵɵtemplate(121, CrearActividadComponent_div_121_Template, 4, 4, \"div\", 66);\n        i0.ɵɵtemplate(122, CrearActividadComponent_p_122_Template, 2, 0, \"p\", 67);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(123, \"div\", 68)(124, \"label\", 69);\n        i0.ɵɵtext(125, \"Participa en la actividad\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(126, \"br\");\n        i0.ɵɵelementStart(127, \"input\", 70);\n        i0.ɵɵlistener(\"change\", function CrearActividadComponent_Template_input_change_127_listener() {\n          return ctx.onCheckboxChange2(1);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(128, \"span\");\n        i0.ɵɵtext(129, \"S\\u00ED\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(130, \"input\", 70);\n        i0.ɵɵlistener(\"change\", function CrearActividadComponent_Template_input_change_130_listener() {\n          return ctx.onCheckboxChange2(2);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(131, \"span\");\n        i0.ɵɵtext(132, \"No\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(133, CrearActividadComponent_button_133_Template, 3, 1, \"button\", 71);\n        i0.ɵɵtemplate(134, CrearActividadComponent_button_134_Template, 3, 1, \"button\", 71);\n        i0.ɵɵelementEnd()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(30);\n        i0.ɵɵtextInterpolate(ctx.titulo);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"formGroup\", ctx.registerForm);\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngIf\", !ctx.campoValido(\"titulo\"));\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngIf\", !ctx.campoValido(\"titulo\"));\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngIf\", !ctx.campoValido(\"requisitos\"));\n        i0.ɵɵadvance(8);\n        i0.ɵɵpropertyInterpolate(\"min\", ctx.hoy);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngIf\", !ctx.campoValido(\"fecha\") || !ctx.campoValido(\"hora\"));\n        i0.ɵɵadvance(19);\n        i0.ɵɵproperty(\"ngIf\", !ctx.campoValido(\"precio\"));\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.campoValido(\"min_participantes\"));\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngIf\", !ctx.campoValido(\"direccion\"));\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngIf\", !ctx.campoValido(\"poblacion\"));\n        i0.ɵɵadvance(8);\n        i0.ɵɵproperty(\"ngForOf\", ctx.listaProvincias);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.campoValido(\"provincia\"));\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngForOf\", ctx.listaFotos);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.listaFotos.length < 4);\n        i0.ɵɵadvance(11);\n        i0.ɵɵproperty(\"ngForOf\", ctx.listaCategorias);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.formSubmit && ctx.faltaCategoria);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"checked\", ctx.checked1);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"checked\", ctx.checked2);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", ctx.nuevo);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.nuevo);\n      }\n    },\n    directives: [i6.RouterLink, i1.ɵNgNoValidate, i1.NgControlStatusGroup, i1.FormGroupDirective, i1.DefaultValueAccessor, i1.NgControlStatus, i1.FormControlName, i1.RequiredValidator, i7.NgIf, i1.MinLengthValidator, i1.NumberValueAccessor, i1.SelectControlValueAccessor, i1.NgSelectOption, i1.ɵNgSelectMultipleOption, i7.NgForOf],\n    styles: [\"\"]\n  });\n  return CrearActividadComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}