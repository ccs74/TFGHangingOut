{"ast":null,"code":"import Swal from 'sweetalert2';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/actividades.service\";\nimport * as i2 from \"src/app/services/usuario.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/common\";\n\nconst _c0 = function (a1) {\n  return [\"/actividades/editar-actividad/\", a1];\n};\n\nconst _c1 = function (a1) {\n  return [\"/actividades/editar-actividad\", a1];\n};\n\nfunction ActividadesOrganizadasComponent_div_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\")(1, \"div\", 19)(2, \"h5\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 20)(5, \"h3\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(7, \"i\", 21);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"div\", 22)(9, \"div\", 23);\n    i0.ɵɵelement(10, \"img\", 24);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"div\", 25)(12, \"h3\", 8);\n    i0.ɵɵtext(13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"h4\", 26);\n    i0.ɵɵtext(15);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"h5\", 27)(17, \"strong\");\n    i0.ɵɵtext(18, \"Requisitos: \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(19);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(20, \"div\", 28)(21, \"h3\", 29)(22, \"strong\");\n    i0.ɵɵtext(23, \"Precio: \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(24);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(25, \"h3\");\n    i0.ɵɵtext(26);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(27, \"i\", 30);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const actividad_r2 = ctx.$implicit;\n    i0.ɵɵclassMap(actividad_r2.clase);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(actividad_r2.fecha2);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(actividad_r2.poblacion);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(16, _c0, actividad_r2.uid));\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate1(\"src\", \"../../../assets/imgs/actividades/\", actividad_r2.foto, \"\", i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(18, _c0, actividad_r2.uid));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(actividad_r2.titulo);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(actividad_r2.descripcion);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", actividad_r2.requisitos, \"\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate1(\" \", actividad_r2.precio, \"\\u20AC\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate3(\"\", actividad_r2.num_participantes, \" / \", actividad_r2.min_participantes, \" Participantes (M\\u00E1x: \", actividad_r2.max_participantes, \") Completa\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(20, _c1, actividad_r2.uid));\n  }\n}\n\nfunction ActividadesOrganizadasComponent_div_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 31)(1, \"p\");\n    i0.ɵɵtext(2, \"Todav\\u00EDa no has creado ninguna actividad\");\n    i0.ɵɵelementEnd()();\n  }\n}\n\nconst _c2 = function () {\n  return [\"/actividades/organizadas\"];\n};\n\nconst _c3 = function () {\n  return [\"/actividades/asistidas\"];\n};\n\nconst _c4 = function () {\n  return [\"/actividades/favoritas\"];\n};\n\nconst _c5 = function () {\n  return [\"/actividades/crear-actividad\"];\n};\n\nexport let ActividadesOrganizadasComponent = /*#__PURE__*/(() => {\n  class ActividadesOrganizadasComponent {\n    constructor(actividadService, usuarioService) {\n      this.actividadService = actividadService;\n      this.usuarioService = usuarioService;\n      this.listaActividades = [];\n      this.asistidas = [];\n      this.listaVacia = false;\n    }\n\n    ngOnInit() {\n      this.cargarUsuario();\n      this.cargarActividades();\n    }\n\n    cambiarPag() {\n      localStorage.setItem('before', `/actividades/organizadas`);\n    }\n\n    cargarActividades() {\n      this.listaActividades = [];\n      this.actividadService.cargarActividades().subscribe(res => {\n        console.log(res);\n\n        for (let i = 0; i < res['actividades'].length; i++) {\n          console.log(res['actividades'][i].organizador);\n          console.log(this.idUsuario);\n\n          if (!this.idUsuario) {\n            this.cargarUsuario();\n          }\n\n          if (res['actividades'][i].organizador == this.idUsuario) {\n            console.log(\"addActividad\");\n            this.listaActividades.push(res['actividades'][i]);\n          }\n        }\n\n        this.actualizarActividades();\n      }, err => {\n        console.log(err);\n      });\n    }\n\n    actualizarActividades() {\n      for (let i = 0; i < this.listaActividades.length; i++) {\n        this.listaActividades[i].foto = this.listaActividades[i].fotos[0];\n        this.listaActividades[i].fecha2 = this.convertirFecha(this.listaActividades[i].fecha);\n        this.listaActividades[i].asistir = false;\n\n        if (this.listaActividades[i].requisitos.length > 75) {\n          this.listaActividades[i].requisitos = this.listaActividades[i].requisitos.substring(0, 74) + \"...\";\n        }\n\n        if (this.listaActividades[i].poblacion.length > 30) {\n          this.listaActividades[i].poblacion = this.listaActividades[i].poblacion.substring(0, 29) + \"...\";\n        }\n\n        if (this.listaActividades[i].titulo.length > 22) {\n          this.listaActividades[i].titulo = this.listaActividades[i].titulo.substring(0, 21) + \"...\";\n        }\n\n        if (this.listaActividades[i].descripcion.length > 120) {\n          this.listaActividades[i].descripcion = this.listaActividades[i].descripcion.substring(0, 119) + \"...\";\n        } //comprobar fecha\n\n\n        if (this.validarFecha(this.listaActividades[i].fecha)) {\n          this.listaActividades[i].clase = \"cardActividad\";\n        } else {\n          this.listaActividades[i].clase = \"cardActividad1\";\n        }\n      }\n\n      for (let i = 0; i < this.listaActividades.length; i++) {\n        for (let j = 0; j < this.asistidas.length; j++) {\n          if (this.listaActividades[i].uid == this.asistidas[j]) {\n            this.listaActividades[i].asistir = true;\n          }\n        }\n\n        if (this.listaActividades[i].num_participantes == this.listaActividades[i].max_participantes) {\n          this.listaActividades[i].completa = true;\n        } else {\n          this.listaActividades[i].completa = false;\n        }\n      }\n\n      if (this.listaActividades.length == 0) {\n        this.listaVacia = true;\n      } else {\n        this.listaVacia = false;\n      }\n\n      this.listaActividades.sort((a, b) => {\n        return new Date(b.fecha) - new Date(a.fecha);\n      });\n    }\n\n    cargarUsuario() {\n      let usuario = localStorage.getItem('email');\n\n      if (!usuario) {\n        return;\n      }\n\n      this.usuarioService.cargarUsuario(\"\", usuario).subscribe(res => {\n        console.log(res);\n        this.asistidas = res['existeUsuario'].actividades_asistidas;\n        this.idUsuario = res['existeUsuario'].uid;\n      }, err => {\n        Swal.fire({\n          icon: 'error',\n          title: 'Oops...',\n          text: 'No se pudo completar la acción, vuelva a intentarlo'\n        });\n      });\n    }\n\n    convertirFecha(date) {\n      let cadena = \"\";\n      let fecha = new Date(date);\n      let dia,\n          num,\n          mes,\n          hora,\n          min = \"\";\n\n      switch (fecha.getDay()) {\n        case 1:\n          dia = \"Lun\";\n          break;\n\n        case 2:\n          dia = \"Mar\";\n          break;\n\n        case 3:\n          dia = \"Mié\";\n          break;\n\n        case 4:\n          dia = \"Jue\";\n          break;\n\n        case 5:\n          dia = \"Vie\";\n          break;\n\n        case 6:\n          dia = \"Sáb\";\n          break;\n\n        case 0:\n          dia = \"Dom\";\n          break;\n      }\n\n      num = fecha.getDate().toString();\n\n      switch (fecha.getMonth()) {\n        case 0:\n          mes = \"Ene\";\n          break;\n\n        case 1:\n          mes = \"Feb\";\n          break;\n\n        case 2:\n          mes = \"Mar\";\n          break;\n\n        case 3:\n          mes = \"Abr\";\n          break;\n\n        case 4:\n          mes = \"May\";\n          break;\n\n        case 5:\n          mes = \"Jun\";\n          break;\n\n        case 6:\n          mes = \"Jul\";\n          break;\n\n        case 7:\n          mes = \"Ago\";\n          break;\n\n        case 8:\n          mes = \"Sep\";\n          break;\n\n        case 9:\n          mes = \"Oct\";\n          break;\n\n        case 10:\n          mes = \"Nov\";\n          break;\n\n        case 11:\n          mes = \"Dic\";\n          break;\n      }\n\n      let sh = fecha.getHours();\n\n      if (sh < 10) {\n        hora = \"0\" + sh.toString();\n      } else {\n        hora = sh.toString();\n      }\n\n      let sm = fecha.getMinutes();\n\n      if (sm < 10) {\n        min = \"0\" + sm.toString();\n      } else {\n        min = sm.toString();\n      }\n\n      cadena = dia + \", \" + num + \" \" + mes + \" · \" + hora + \":\" + min;\n      return cadena;\n    }\n\n    validarFecha(fecha) {\n      let valida = true;\n      let hoy = new Date();\n      let f = new Date(fecha);\n\n      if (f.getFullYear() < hoy.getFullYear()) {\n        valida = false;\n      } else if (f.getFullYear() == hoy.getFullYear()) {\n        if (f.getMonth() < hoy.getMonth()) {\n          valida = false;\n        } else if (f.getMonth() == hoy.getMonth()) {\n          if (f.getDate() < hoy.getDate()) {\n            valida = false;\n          } else if (f.getDate() == hoy.getDate()) {\n            if (f.getHours() < hoy.getHours()) {\n              valida = false;\n            } else if (f.getHours() == hoy.getHours()) {\n              if (f.getMinutes() <= hoy.getMinutes()) {\n                valida = false;\n              }\n            }\n          }\n        }\n      }\n\n      return valida;\n    }\n\n  }\n\n  ActividadesOrganizadasComponent.ɵfac = function ActividadesOrganizadasComponent_Factory(t) {\n    return new (t || ActividadesOrganizadasComponent)(i0.ɵɵdirectiveInject(i1.ActividadesService), i0.ɵɵdirectiveInject(i2.UsuarioService));\n  };\n\n  ActividadesOrganizadasComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ActividadesOrganizadasComponent,\n    selectors: [[\"app-actividades-organizadas\"]],\n    decls: 33,\n    vars: 10,\n    consts: [[\"id\", \"admin-back\"], [1, \"admin-header\"], [1, \"d-flex\", \"justify-content-between\"], [1, \"d-flex\"], [\"src\", \"../../../assets/imgs/Logo.png\", 1, \"logo\"], [\"routerLink\", \"/editar-perfil\", 1, \"fa-solid\", \"fa-user\", \"fa-3x\", 3, \"click\"], [1, \"menuActividades\", \"d-flex\"], [1, \"selected\", 3, \"routerLink\"], [3, \"routerLink\"], [1, \"resultados5\"], [3, \"class\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"listaVacia\", 4, \"ngIf\"], [1, \"addActividad\", 3, \"routerLink\"], [1, \"navBarCliente\", \"d-flex\"], [\"routerLink\", \"/usuarios\", 1, \"fa-solid\", \"fa-user-group\", \"fa-3x\"], [1, \"clicked\"], [\"routerLink\", \"/actividades/organizadas\", 1, \"fa-solid\", \"fa-rectangle-list\", \"fa-3x\"], [\"routerLink\", \"/resultados-actividades\", 1, \"fa-solid\", \"fa-magnifying-glass\", \"fa-3x\"], [\"routerLink\", \"/chats\", 1, \"fa-solid\", \"fa-comments\", \"fa-3x\"], [1, \"infoActivity\", \"d-flex\"], [1, \"location\", \"d-flex\"], [1, \"fa-solid\", \"fa-location-dot\"], [1, \"activity-content\", \"d-flex\"], [1, \"marcoFActividad\", 3, \"routerLink\"], [1, \"fActividad\", 3, \"src\"], [1, \"ml-4\", \"mr-6\", \"descActivity\"], [1, \"desc\"], [1, \"requisitos\"], [1, \"d-flex\", \"activityFooter\", \"participantes2\", \"justify-content-between\"], [1, \"mr-3\"], [1, \"fa-solid\", \"fa-pen-to-square\", \"asistir\", 3, \"routerLink\"], [1, \"listaVacia\"]],\n    template: function ActividadesOrganizadasComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"section\", 0)(1, \"header\", 1)(2, \"div\", 2)(3, \"div\", 3);\n        i0.ɵɵelement(4, \"img\", 4);\n        i0.ɵɵelementStart(5, \"h1\");\n        i0.ɵɵtext(6, \"Actividades\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(7, \"i\", 5);\n        i0.ɵɵlistener(\"click\", function ActividadesOrganizadasComponent_Template_i_click_7_listener() {\n          return ctx.cambiarPag();\n        });\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(8, \"div\", 6)(9, \"button\", 7);\n        i0.ɵɵtext(10, \"Organizadas\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"button\", 8);\n        i0.ɵɵtext(12, \"Asistir\\u00E9\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(13, \"button\", 8);\n        i0.ɵɵtext(14, \"Favoritas\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(15, \"div\", 9);\n        i0.ɵɵtemplate(16, ActividadesOrganizadasComponent_div_16_Template, 28, 22, \"div\", 10);\n        i0.ɵɵtemplate(17, ActividadesOrganizadasComponent_div_17_Template, 3, 0, \"div\", 11);\n        i0.ɵɵelementStart(18, \"button\", 12);\n        i0.ɵɵtext(19, \"A\\u00F1adir\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(20, \"div\", 13)(21, \"div\")(22, \"button\");\n        i0.ɵɵelement(23, \"i\", 14);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(24, \"div\", 15)(25, \"button\");\n        i0.ɵɵelement(26, \"i\", 16);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(27, \"div\")(28, \"button\");\n        i0.ɵɵelement(29, \"i\", 17);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(30, \"div\")(31, \"button\");\n        i0.ɵɵelement(32, \"i\", 18);\n        i0.ɵɵelementEnd()()()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(9);\n        i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(6, _c2));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(7, _c3));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(8, _c4));\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngForOf\", ctx.listaActividades);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.listaVacia);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(9, _c5));\n      }\n    },\n    directives: [i3.RouterLink, i4.NgForOf, i4.NgIf],\n    styles: [\"\"]\n  });\n  return ActividadesOrganizadasComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}