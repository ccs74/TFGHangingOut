<section class="mt-2 admin-nav">
    <header class="admin-header">
        <div class="d-flex">
            <img src="../../../assets/imgs/Logo.png" class="logo">
            <h1 class="mt-5">Panel de Control</h1>
        </div>

    </header>
    <!-- Común en la parte de admin -->
    <nav class="admin-nav">
        <div class="float-left mr-1">
            <div class="dropdown">
                <button class="menuBoton" type="button" data-toggle="dropdown">
                  <i class="fa-solid fa-bars fa-2x p-1"></i>
                </button>
                <div class="dropdown-menu">
                    <div class="dropdown-option">
                        <button routerLink="/admin/usuarios">Usuarios</button>
                    </div>
                    <div class="dropdown-option">
                        <button routerLink="/admin/actividades">Actividades</button>
                    </div>
                    <div class="dropdown-option">
                        <button routerLink="/admin/categorias">Categorías</button>
                    </div>
                    <div class="dropdown-option">
                        <button routerLink="/admin/incidencias">Incidencias</button>
                    </div>
                    <div class="dropdown-option">
                        <button class="logOutAdmin" (click)="logout()">Cerrar Sesión</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="d-flex admin-nav-title ">
            <div class="ml-2 my-auto">
                <h4 class="title2 mt-2">{{titulo}}</h4>
            </div>
            <div class="d-flex my-auto">
                <i class="fa-solid fa-arrow-rotate-left fa-2x mx-3" routerLink="/admin/actividades"></i>
            </div>
        </div>
    </nav>
</section>
<div class="resultados">
    <form [formGroup]="registerForm" (ngSubmit)="crearActividad()">
        <div>
            <label class="tituloForm mt-3" for="nombre">Titulo*</label><br>
            <input class="inputForm" type="text" formControlName="titulo" required>
        </div>
        <p class="small text-danger font-italic invalid-msg" *ngIf="!campoValido('titulo')">* El titulo es obligatorio</p>
        <div>
            <label class="tituloForm" for="descripcion">Descripción*</label><br>
            <textarea class="inputForm" formControlName="descripcion" minlength="120" required></textarea>
        </div>
        <p class="small text-danger font-italic invalid-msg" *ngIf="!campoValido('titulo')">* La descripción es obligatoria y debe tener al menos 120 caracteres</p>
        <div>
            <label class="tituloForm" for="requisitos">Requisitos*</label><br>
            <textarea class="inputForm" formControlName="requisitos" required></textarea>
        </div>
        <p class="small text-danger font-italic invalid-msg" *ngIf="!campoValido('requisitos')">* Los requisitos son obligatorios</p>
        <div>
            <h1 class="tituloForm">Fecha y Hora*</h1>
            <div class="d-flex">
                <div class="fecha">
                    <label for="fecha"></label>
                    <div class="d-flex">
                        <input class="inputForm" type="date" formControlName="fecha" value="dd/mm/aaaa" min="{{hoy}}" required>
                        <i class="fa-solid fa-calendar-days crearActividadCalendario"></i>
                    </div>
                </div>
                <div class="hora">
                    <label for="hora"></label>
                    <input class="inputForm" type="time" formControlName="hora" value="hh:mm" required>
                </div>
            </div>
            <p class="small text-danger font-italic invalid-msg" *ngIf="!campoValido('fecha') || !campoValido('hora')">* La fecha y hora son obligatorias</p>

        </div>
        <div class="d-flex">
            <div>
                <label class="tituloForm" for="precio">Precio (€)*</label>
                <input class="inputForm" type="number" id="precio" formControlName="precio" required>

            </div>
            <div style="margin-top: 4px;">
                <h1 class="tituloForm">Participantes*</h1>
                <div class="d-flex">
                    <div class="d-flex ml-3 participants">
                        <label for="minimo">Mín: </label>
                        <input class="inputForm" type="number" formControlName="min_participantes" value="0" required>
                    </div>
                    <div class="d-flex participants">
                        <label for="maximo">Máx: </label>
                        <input class="inputForm" type="number" formControlName="max_participantes">
                    </div>
                </div>
            </div>
        </div>
        <div class="d-flex">
            <p class="small text-danger font-italic invalid-msg" *ngIf="!campoValido('precio')">* El precio es obligatorio</p>
            <p class="small text-danger font-italic invalid-msg" *ngIf="!campoValido('min_participantes')">* Por favor, introduzca un mínimo de participantes</p>
        </div>
        <div>
            <label class="tituloForm" for="direccion">Dirección*</label>
            <input type="text" class="inputForm" formControlName="direccion">
        </div>
        <p class="small text-danger font-italic invalid-msg" *ngIf="!campoValido('direccion')">* La direccion es obligatoria</p>
        <div>
            <label class="tituloForm" for="poblacion">Población*</label>
            <input class="inputForm" type="text" formControlName="poblacion" required>
        </div>
        <p class="small text-danger font-italic invalid-msg" *ngIf="!campoValido('poblacion')">* La población es obligatoria</p>
        <div>
            <label class="tituloForm" for="provincia">Provincia*</label><br>
            <select class="inputForm" id="provincia" formControlName="provincia">
              <option value="" disabled selected>Provincia</option>
              <option *ngFor="let provincia of listaProvincias" value={{provincia.uid}}>{{provincia.nombre}}</option>
            </select>
        </div>
        <p class="small text-danger font-italic invalid-msg" *ngIf="!campoValido('provincia')">* La provincia es obligatoria</p>
        <div>
            <label class="tituloForm" for="fotos">Fotos</label>
            <div class="d-flex pr-3">
                <div *ngFor="let foto of listaFotos" class="marcoFActividad2 mt-0">
                    <img src="{{foto}}" class="fActividad">
                </div>
                <div *ngIf="listaFotos.length < 4" class="addFoto">
                    <i class="fa-solid fa-plus" (click)="fileInput.click()"></i>
                </div>
            </div>
            <div>
                <button type="button" class="borrarFotos" (click)="borrarFotos()">Borrar fotos</button>
            </div>
        </div>
        <div class="divInputFile mt-3 mx-4">
            <!-- <button id="selectButton" mat-raised-button >Select File to Upload</button> -->
            <input #fileInput id="inputFile" type="file" accept=".png, .jpg, .jpeg" hidden accept='image/*' (change)="selectFiles($event)" />
        </div>
        <div id="categorias">
            <label class="tituloForm" for="categorias">Categorías*</label><br>
            <div *ngFor="let categoria of listaCategorias; let i = index">
                <input type="checkbox" class="mr-2 ml-4 checkCategoria" id="{{categoria.uid}}" value="{{categoria.nombre}}" [checked]="categoria.marcado" (change)="onCheckboxChange($event, categoria.uid)">
                <label class="form-check-label" for="categoria">{{categoria.nombre}}</label>
            </div>
            <p class="small text-danger font-italic invalid-msg mt-1" *ngIf="formSubmit && faltaCategoria">* Por favor, seleccione mínimo una categoría</p>
        </div>
        <div class="participa mt-3">
            <label class="tituloForm" for="participa">Participa en la actividad</label><br>
            <input type="checkbox" [checked]="checked1" (change)="onCheckboxChange2(1)">
            <span>Sí</span>
            <input type="checkbox" [checked]="checked2" (change)="onCheckboxChange2(2)">
            <span>No</span>
        </div>
        <button *ngIf="nuevo" class="big-button mt-5" type="submit"><i class="fa fa-spinner fa-spin mr-2"*ngIf="waiting"></i>Crear Actividad</button>
        <button *ngIf="!nuevo" class="big-button mt-5" type="submit"><i class="fa fa-spinner fa-spin mr-2"*ngIf="waiting"></i>Editar Actividad</button>
    </form>
</div>
