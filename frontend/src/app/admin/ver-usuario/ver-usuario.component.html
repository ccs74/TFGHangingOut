<section class="mt-2 admin-nav">
    <header class="admin-header">
        <div class="d-flex">
            <img src="../../../assets/imgs/Logo.png" class="logo">
            <h1 class="mt-5">Panel de Control</h1>
        </div>

    </header>
    <!-- Común en la parte de admin -->
    <nav class="admin-nav">
        <div class="float-left mr-1">
            <div class="dropdown">
                <button class="menuBoton" type="button" data-toggle="dropdown">
            <i class="fa-solid fa-bars fa-2x p-1"></i>
          </button>
                <div class="dropdown-menu">
                    <div class="dropdown-option">
                        <button routerLink="/admin/usuarios">Usuarios</button>
                    </div>
                    <div class="dropdown-option">
                        <button routerLink="/admin/actividades">Actividades</button>
                    </div>
                    <div class="dropdown-option">
                        <button routerLink="/admin/categorias">Categorías</button>
                    </div>
                    <div class="dropdown-option">
                        <button routerLink="/admin/incidencias">Incidencias</button>
                    </div>
                    <div class="dropdown-option">
                        <button class="logOutAdmin" (click)="logout()">Cerrar Sesión</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="d-flex admin-nav-title ">
            <div class="ml-2 my-auto">
                <h4 class="title2 mt-2">Ver Usuario</h4>
            </div>
            <div class="d-flex my-auto">
                <i class="fa-solid fa-arrow-rotate-left fa-2x mx-3" routerLink="/admin/usuarios"></i>
            </div>
        </div>
    </nav>
</section>
<div class="infoUsuario">
    <div class="mx-auto text-center">
        <div *ngIf="usuario" class="marcoFPerfil3">
            <img src="../../../assets/imgs/usuarios/{{usuario.foto}}" class="fPerfil">
        </div>
        <h2 *ngIf="usuario" class="nombreUsuario">{{usuario.nombre}} {{usuario.apellidos}}</h2>
    </div>
    <div class="datosActividad">
        <h1>Email</h1>
        <p *ngIf="usuario">{{usuario.email}}</p>
    </div>
    <div class="datosActividad">
        <h1>Descripción</h1>
        <p *ngIf="usuario">{{usuario.descripcion}}</p>
    </div>
    <div class="d-flex">
        <div class="datosActividad">
            <h1>Edad</h1>
            <p *ngIf="edad">{{edad}} años, nacido el {{nacimiento}}</p>
        </div>
    </div>
    <div class="datosActividad">
        <div class="d-flex">
            <h1>Vive en...</h1>
            <i class="fa-solid fa-location-dot fa-3x verUsuarioLocation"></i>
        </div>
        <p *ngIf="usuario && provincia">{{usuario.poblacion}} ({{provincia}})</p>
    </div>
    <div *ngIf="usuario && usuario.bloqueado" class="datosActividad">
        <h1>Bloqueado</h1>
        <p class="desbloquearAdmin" (click)="desbloquear(usuario.uid)">Desbloquear</p>
    </div>
    <div class="datosActividad">
        <h1>Actividades</h1>
        <p *ngIf="numActividades !== 1">Ha organizado: {{numActividades}} actividades</p>
        <p *ngIf="numActividades === 1">Ha organizado: {{numActividades}} actividad</p>
        <a *ngIf="numActividades > 0 && mostrarActividades == false" (click)="mostrarActividadesCreadas(true)">Ver actividades</a>
        <a *ngIf="numActividades > 0 && mostrarActividades == true" (click)="mostrarActividadesCreadas(false)">Ocultar Actividades</a>
    </div>
    <div *ngIf="mostrarActividades">
        <div *ngFor="let actividad of listaActividades" class="cardActividad">
            <div class="infoActivity d-flex">
                <h5>{{actividad.fecha2}}</h5>
                <div class="location d-flex">
                    <h3>{{actividad.poblacion}}</h3>
                    <i class="fa-solid fa-location-dot"></i>
                </div>
            </div>
            <div class="activity-content d-flex">
                <div class="marcoFActividad" [routerLink]="['/actividades/ver-actividad/', actividad.uid]">
                    <!-- Foto -->
                    <img src="../../../assets/imgs/actividades/{{actividad.foto}}" class="fActividad">
                </div>
                <div class="ml-4 mr-6 descActivity">
                    <h3 [routerLink]="['/actividades/ver-actividad/', actividad.uid]">{{actividad.titulo}}</h3>
                    <h4 class="desc">{{actividad.descripcion}}</h4>
                    <h5 class="requisitos"><strong>Requisitos: </strong> {{actividad.requisitos}}</h5>
                </div>
            </div>
            <p class="infoEmail" [routerLink]="['/chats/', actividad.uid]">{{actividad.email}}</p>
            <div class="d-flex activityFooter">
                <h3 class="precio"><strong>Precio: </strong> {{actividad.precio}}€</h3>

                <div class="participantes d-flex">
                    <h3>{{actividad.num_participantes}} Participantes </h3>
                    <p *ngIf="!actividad.completa">(Mín: {{actividad.min_participantes}} - Máx: {{actividad.max_participantes}})</p>
                    <p *ngIf="actividad.completa" class="actividadCompleta">Completa</p>
                </div>
            </div>
        </div>
    </div>
    <div class="datosActividad">
        <h1>Incidencias</h1>
        <p *ngIf="usuario && numIncidencias !== 1">Este usuario tiene: {{numIncidencias}} incidencias</p>
        <p *ngIf="usuario && numIncidencias === 1">Este usuario tiene: {{numIncidencias}} incidencia</p>
        <a *ngIf="numIncidencias > 0 && mostrarIncidencias == false" (click)="mostrarIncidenciasUsuario(true)">Ver Incidencias</a>
        <a *ngIf="numActividades > 0 && mostrarIncidencias == true" (click)="mostrarIncidenciasUsuario(false)">Ocultar Incidencias</a>
    </div>
    <div *ngIf="mostrarIncidencias">
        <div class="cardActividad" *ngFor="let incidencia of listaIncidencias">
            <div class="infoActivity d-flex">
                <h3 style="color: #999999;">{{incidencia.fecha2}}</h3>
                <h2 *ngIf="incidencia.estado == 'Pendiente'" (click)="setBefore()" class="resolverLink" [routerLink]="['/admin/incidencias/resolver-incidencia/', incidencia.uid]">Resolver</h2>
            </div>
            <table class="divIncidencia">
                <tbody>
                    <tr>
                        <th>Denunciante:</th>
                        <td>{{incidencia.emailDenunciante}}</td>
                    </tr>
                    <tr>
                        <th>Denunciado:</th>
                        <td>{{incidencia.emailDenunciado}}</td>
                    </tr>
                    <tr>
                        <th>Motivo:</th>
                        <td>{{incidencia.motivo2}}</td>
                    </tr>
                    <tr>
                        <th>Estado:</th>
                        <td>{{incidencia.estado}}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
