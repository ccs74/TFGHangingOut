<section id="admin-back">
    <header class="admin-header">
        <div class="d-flex justify-content-between">
            <div class="d-flex">
                <img src="../../../assets/imgs/Logo.png" class="logo">
                <h1>Explorar</h1>
            </div>
            <i class="fa-solid fa-user fa-3x" (click)="cambiarPag()" routerLink="/editar-perfil"></i>
        </div>
    </header>
    <div class="buscador d-flex">
        <i class="fa-solid fa-filter fa-2x" (click)="activarFiltros()"></i>
        <form class="mt-4">
            <label for="textoBusqueda"></label>
            <input type="text" #textoBuscar id="textoBusqueda" placeholder="Buscar..." (keyup)="updateTexto(textoBuscar.value)">
            <i class="fa-solid fa-magnifying-glass fa-2x iconoBuscador"></i>
        </form>
    </div>
    <div *ngIf="mostrarFiltros" class="separacion3"></div>
    <div *ngIf="mostrarFiltros" class="filtros">
        <form [formGroup]="filtrosForm" (ngSubmit)="buscarActividades()">
            <div>
                <h1>¿Dónde quieres hacer las actividades?</h1>
                <div class="d-flex">
                    <input type="text" id="lugar" formControlName="lugar" placeholder="Población...">
                    <i class="fa-solid fa-location-dot fa-2x"></i>
                </div>
            </div>
            <div class="separacion4"></div>
            <div>
                <h1>¿Qué te apetece?</h1>
                <div class="d-flex flex-row flex-wrap intereses">
                    <div *ngFor="let categoria of listaCategorias">
                        <button type="button" (click)="onCheckboxChange($event, categoria.uid)" class="{{categoria.clase}}">{{categoria.nombre}}</button>
                    </div>
                </div>
            </div>
            <div class="separacion4"></div>
            <div>
                <h1>¿Cuándo?</h1>
                <label for="fecha"></label>
                <div class="d-flex mb-4">
                    <div *ngFor="let dia of listaFecha" class="containerFecha">
                        <button type="button" class="{{dia.clase}}" (click)="oncheckChanged($event, dia.uid)">{{dia.nombre}}</button>
                    </div>
                </div>
                <div class="d-flex">
                    <input type="date" name="fecha" formControlName="fecha" id="fecha">
                    <i class="fa-solid fa-calendar-days fa-2x ml-3 mt-1" style="color: #85C8FF;"></i>
                </div>

            </div>
            <div class="separacion4"></div>
            <div>
                <h1>Precio (€)</h1>
                <label for="precio"></label>
                <div class="d-flex precios">
                    <div class="d-flex">
                        <span>Mín: </span>
                        <input type="number" id="precio" formControlName="min">
                    </div>
                    <div class="d-flex ml-4">
                        <span>Máx: </span>
                        <input type="number" id="precio" formControlName="max">
                    </div>
                </div>
            </div>
            <div class="separacion4"></div>
            <div>
                <div class="d-flex">
                    <label class="checkpopularidad" for="popularidad">
                      <input type="checkbox" id="popularidad" name="popularidad" (click)="checkPopularidad($event)">
                      <span>Ordenar por popularidad</span>
                  </label>
                </div>

                <button class="px-5 form-button" type="submit">Buscar</button>
            </div>
        </form>
    </div>
    <div *ngIf="!mostrarFiltros" class="text-center listaResultados">
        <h1>Resultados</h1>
    </div>
    <div *ngIf="!mostrarFiltros" class="resultados2">
        <div *ngIf="listaVacia" class="cardActividad text-center">
            <h3 class="mx-4" style="font-size: 1em; color: #737373;">Lo sentimos, ninguna actividad coincide con tu búsqueda</h3>
        </div>
        <div *ngFor="let actividad of listaActividades" class="cardActividad">
            <div class="infoActivity d-flex">
                <h5>{{actividad.fecha2}}</h5>
                <div class="location d-flex">
                    <h3>{{actividad.poblacion}}</h3>
                    <i class="fa-solid fa-location-dot"></i>
                </div>
            </div>
            <div class="activity-content d-flex">
                <div class="marcoFActividad" [routerLink]="['/actividades/ver-actividad/', actividad.uid]">
                    <!-- Foto -->
                    <img src="../../../assets/imgs/actividades/{{actividad.foto}}" class="fActividad">
                </div>
                <div class="ml-4 mr-6 descActivity">
                    <h3 [routerLink]="['/actividades/ver-actividad/', actividad.uid]">{{actividad.titulo}}</h3>
                    <h4 class="desc">{{actividad.descripcion}}</h4>
                    <h5 class="requisitos"><strong>Requisitos: </strong> {{actividad.requisitos}}</h5>
                    <div *ngIf="actividad.fechaValida" class="d-flex justify-content-end mr-2">
                        <div class="botones-actividad d-flex">
                            <i *ngIf="!actividad.favorito" class="fa-regular fa-heart meGusta" (click)="marcarFavorito(actividad.uid, true)"></i>
                            <i *ngIf="actividad.favorito" class="fa-solid fa-heart meGusta" (click)="marcarFavorito(actividad.uid, false)"></i>
                            <i *ngIf="actividad.asistir" class="fa-solid fa-circle-check asistir" (click)="marcarAsistencia(actividad.uid, false)"></i>
                            <i *ngIf="!actividad.asistir && !actividad.completa" class="fa-regular fa-circle-check asistir" (click)="marcarAsistencia(actividad.uid, true)"></i>
                        </div>
                    </div>
                </div>
            </div>
            <p class="infoEmail" [routerLink]="['/chats/', actividad.uid]">{{actividad.email}}</p>
            <div class="d-flex activityFooter">
                <h3 class="precio"><strong>Precio: </strong> {{actividad.precio}}€</h3>

                <div class="participantes d-flex">
                    <h3>{{actividad.num_participantes}} Participantes </h3>
                    <p *ngIf="!actividad.completa">(Mín: {{actividad.min_participantes}} - Máx: {{actividad.max_participantes}})</p>
                    <p *ngIf="actividad.completa" class="actividadCompleta">Completa</p>
                </div>
            </div>
        </div>
    </div>

    <div class="navBarCliente d-flex">
        <div>
            <button><i class="fa-solid fa-user-group fa-3x" routerLink="/usuarios"></i></button>
        </div>
        <div>
            <button><i class="fa-solid fa-rectangle-list fa-3x" routerLink="/actividades/organizadas"></i></button>
        </div>
        <div class="clicked">
            <button><i class="fa-solid fa-magnifying-glass fa-3x" routerLink="/resultados-actividades"></i></button>
        </div>
        <div>
            <button><i class="fa-solid fa-comments fa-3x" routerLink="/chats"></i></button>
        </div>
    </div>
</section>
